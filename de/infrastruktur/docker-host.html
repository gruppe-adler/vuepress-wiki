<!DOCTYPE html>
<html lang="de">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>🖥 Docker Host | Wiki - Gruppe Adler</title>
    <meta name="description" content="Hier findest du alles von Organisationsstruktur, über Scripts, bis zu Taktikgelaber.">
    <link rel="icon" href="/wiki.gruppe-adler.de/favicon.ico">
    
    <link rel="preload" href="/wiki.gruppe-adler.de/assets/css/0.styles.533a18bd.css" as="style"><link rel="preload" href="/wiki.gruppe-adler.de/assets/js/app.1b06e0ef.js" as="script"><link rel="preload" href="/wiki.gruppe-adler.de/assets/js/4.01aab508.js" as="script"><link rel="preload" href="/wiki.gruppe-adler.de/assets/js/1.9d972ef3.js" as="script"><link rel="preload" href="/wiki.gruppe-adler.de/assets/js/15.cf06986b.js" as="script"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/10.c2b6af22.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/11.9edb86aa.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/12.ac5ae795.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/13.ce0bf753.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/14.d78ef694.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/16.658af9e9.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/17.c24afcb8.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/18.7368695a.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/19.5b08a2e7.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/20.f97a0a55.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/21.f51f996d.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/22.0c7b5b5a.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/23.b0c126e7.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/24.906c9461.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/25.3c621885.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/26.457dc371.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/27.068de67a.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/28.bfb72218.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/29.58dd654a.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/3.a4eac80e.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/30.1fedc09e.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/31.58a9a974.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/32.343e3257.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/33.f0dfd98c.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/34.3a76e2bf.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/35.227e618f.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/36.82953a51.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/37.4bb83d2c.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/38.523cf4c4.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/39.81f92bca.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/40.f719c0c4.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/41.52501752.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/42.b5f24023.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/5.08ceb1c3.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/6.dba61f68.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/7.8a2cface.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/8.a985a187.js"><link rel="prefetch" href="/wiki.gruppe-adler.de/assets/js/9.5d3a8e3a.js">
    <link rel="stylesheet" href="/wiki.gruppe-adler.de/assets/css/0.styles.533a18bd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/wiki.gruppe-adler.de/de/" class="home-link router-link-active"><!----> <span class="site-name">Wiki - Gruppe Adler</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/wiki.gruppe-adler.de/de/bastelstube/" class="nav-link">Bastelstube</a></div><div class="nav-item"><a href="/wiki.gruppe-adler.de/de/infrastruktur/" class="nav-link router-link-active">Infrastruktur</a></div><div class="nav-item"><a href="/wiki.gruppe-adler.de/de/organisatorisches/" class="nav-link">Organisatorisches</a></div><div class="nav-item"><a href="/wiki.gruppe-adler.de/de/taktik/" class="nav-link">Taktik</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Sprachen</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wiki.gruppe-adler.de/de/infrastruktur/docker-host.html" class="nav-link router-link-exact-active router-link-active">Deutsch</a></li><li class="dropdown-item"><!----> <a href="/wiki.gruppe-adler.de/en/" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/gruppe-adler/wiki.gruppe-adler.de" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/wiki.gruppe-adler.de/de/bastelstube/" class="nav-link">Bastelstube</a></div><div class="nav-item"><a href="/wiki.gruppe-adler.de/de/infrastruktur/" class="nav-link router-link-active">Infrastruktur</a></div><div class="nav-item"><a href="/wiki.gruppe-adler.de/de/organisatorisches/" class="nav-link">Organisatorisches</a></div><div class="nav-item"><a href="/wiki.gruppe-adler.de/de/taktik/" class="nav-link">Taktik</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Sprachen</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/wiki.gruppe-adler.de/de/infrastruktur/docker-host.html" class="nav-link router-link-exact-active router-link-active">Deutsch</a></li><li class="dropdown-item"><!----> <a href="/wiki.gruppe-adler.de/en/" class="nav-link">English</a></li></ul></div></div> <a href="https://github.com/gruppe-adler/wiki.gruppe-adler.de" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Infrastruktur</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/wiki.gruppe-adler.de/de/infrastruktur/" class="sidebar-link">❔ Einleitung</a></li><li><a href="/wiki.gruppe-adler.de/de/infrastruktur/docker-host.html" class="active sidebar-link">🖥 Docker Host</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/wiki.gruppe-adler.de/de/infrastruktur/docker-host.html#einleitung" class="sidebar-link">Einleitung</a></li><li class="sidebar-sub-header"><a href="/wiki.gruppe-adler.de/de/infrastruktur/docker-host.html#zugriff-auf-vm" class="sidebar-link">Zugriff auf VM</a></li><li class="sidebar-sub-header"><a href="/wiki.gruppe-adler.de/de/infrastruktur/docker-host.html#die-wichtigsten-container" class="sidebar-link">Die wichtigsten Container</a></li><li class="sidebar-sub-header"><a href="/wiki.gruppe-adler.de/de/infrastruktur/docker-host.html#docker-networks" class="sidebar-link">Docker Networks</a></li><li class="sidebar-sub-header"><a href="/wiki.gruppe-adler.de/de/infrastruktur/docker-host.html#docker-compose-files" class="sidebar-link">Docker Compose Files</a></li><li class="sidebar-sub-header"><a href="/wiki.gruppe-adler.de/de/infrastruktur/docker-host.html#cheat-sheet" class="sidebar-link">Cheat Sheet</a></li></ul></li><li><a href="/wiki.gruppe-adler.de/de/infrastruktur/gruppe-adler-modset.html" class="sidebar-link">📁 Gruppe Adler Modset</a></li><li><a href="/wiki.gruppe-adler.de/de/infrastruktur/styleguide-design.html" class="sidebar-link">🌈 Styleguide Design</a></li><li><a href="/wiki.gruppe-adler.de/de/infrastruktur/uebersicht.html" class="sidebar-link">📝 Liste der Adler-Infrastruktur</a></li><li><a href="/wiki.gruppe-adler.de/de/infrastruktur/wiki-how-to.html" class="sidebar-link">❓ Wiki How-To</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker-host"><a href="#docker-host" class="header-anchor">#</a> 🖥 Docker Host</h1> <h2 id="einleitung"><a href="#einleitung" class="header-anchor">#</a> Einleitung</h2> <p>Die Gruppe Adler verfügt über einen Dedicated Server auf welchem zwei Virtuelle Maschinen laufen. Eine dieser VMs ist der <em>Docker Host</em>, auf welchem Services wie Blechadler, Homepage, CMS, Forum, API, Slotting und einige weitere Tools als jeweils ein/mehrere Docker Container laufen.</p> <h2 id="zugriff-auf-vm"><a href="#zugriff-auf-vm" class="header-anchor">#</a> Zugriff auf VM</h2> <p>Genaueres zum Zugriff gibt es <a href="https://github.com/gruppe-adler/ips-n-stuff" target="_blank" rel="noopener noreferrer">hier<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>.</p> <h2 id="die-wichtigsten-container"><a href="#die-wichtigsten-container" class="header-anchor">#</a> Die wichtigsten Container</h2> <p>Alle Applikationen (ein oder mehrere zusammenhörigen Container) sind grundsätzlich unabhängig von einander aufgebaut. Hierbei gibt es aber einige Ausnahmen:</p> <h3 id="reverse-proxy"><a href="#reverse-proxy" class="header-anchor">#</a> Reverse Proxy</h3> <p>Da mehrere Applikationen von außen auf Port 80 <em>(http)</em> / 443 <em>(https)</em> erreichbar sein sollen, muss ein reverse proxy zum Einsatz kommen. Hierfür kommt <a href="https://github.com/jwilder/nginx-proxy" target="_blank" rel="noopener noreferrer">nginx-proxy<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> und <a href="https://github.com/JrCs/docker-letsencrypt-nginx-proxy-companion" target="_blank" rel="noopener noreferrer">nginx-proxy-le<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> (für das automatische Lösen von Let's Encrypt Zertifikaten) zum Einsatz.<br>
Alle Container die nun auch per http(s) erreichbar sein sollen, müssen nur noch zwei Anforderungen erfüllen:</p> <ol><li>Dem <code>nginx-proxy</code> Docker Netzwerk hinzugefügt sein.</li> <li>Folgende Environment Variablen gesetzt haben (Hierbei natürlich <code>foo</code> durch korrekten Wert ersetzen):
<ul><li><code>VIRTUAL_HOST=foo.gruppe-adler.de,www.foo.gruppe-adler.de</code></li> <li><code>LETSENCRYPT_HOST=foo.gruppe-adler.de</code></li></ul></li></ol> <p><img src="/wiki.gruppe-adler.de/assets/img/container-structure.32f7cc02.svg" alt="container-structure"></p> <h3 id="watchtower"><a href="#watchtower" class="header-anchor">#</a> Watchtower</h3> <p>Um die Entwicklung zu vereinfachen und ein Continuous Deployment zu gewährleisten, wird <a href="https://github.com/containrrr/watchtower" target="_blank" rel="noopener noreferrer">Watchtower<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> eingesetzt. Dieser Container prüft periodisch ob auf Docker Hub eine neuere Versionen eines verwendeten Images zu Verfügung steht. Falls eine neue Version gefunden wurde, lädt watchtower das neue Image und  updated den betroffenen Container komplett automatisch.<br>
Bei uns ist es so eingestellt, dass nur Container, bei denen es explizit eingeschaltet wurde, von Watchtower geupdated werden. Dies erfolgt durch das setzen des <code>com.centurylinklabs.watchtower.enable=true</code> <a href="https://docs.docker.com/engine/reference/commandline/run/#set-metadata-on-container--l---label---label-file" target="_blank" rel="noopener noreferrer">label<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>. Mehr dazu lässt sich in der <a href="https://containrrr.github.io/watchtower/container-selection/" target="_blank" rel="noopener noreferrer">watchtower Dokumentation<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> lesen.</p> <h2 id="docker-networks"><a href="#docker-networks" class="header-anchor">#</a> Docker Networks</h2> <p><em>soonTM</em></p> <h2 id="docker-compose-files"><a href="#docker-compose-files" class="header-anchor">#</a> Docker Compose Files</h2> <p>Alle Docker Compose Konfigurationsdateien lassen sich unter <code>/etc/docker-configs/</code> finden. Der gundlegende Aufbau ist wie folgt:</p> <pre class="vue-container"><code><p><code>/etc/docker-configs</code>
├── <code>homepage</code> <em>Hier befindet sich alles zur Homepage</em>
│
├── <code>blechadler</code> <em>Hier befinden sich alles zum Blechadler</em>
│     ├── docker-compose.yml <em>Docker Compose Konfiguration für Blechadler</em>
│     └── volumes <em>Enthält soft links zu allen docker volumes für Blechadler</em>
│           ├── <em>[...]</em>
│           └── config <em>Link zu <strong>config</strong> volume</em>
│
└── <em>[...]</em></p>
</code></pre><h2 id="cheat-sheet"><a href="#cheat-sheet" class="header-anchor">#</a> Cheat Sheet</h2> <h3 id="vm-neuststarten"><a href="#vm-neuststarten" class="header-anchor">#</a> VM neuststarten</h3> <p><code>reboot</code></p> <h3 id="alle-container-auflisten"><a href="#alle-container-auflisten" class="header-anchor">#</a> Alle Container auflisten</h3> <p><code>docker ps -a</code><br> <img src="/wiki.gruppe-adler.de/assets/img/list-containers.e16871f2.png" alt="list-containers"></p> <h3 id="eine-applikation-neu-starten"><a href="#eine-applikation-neu-starten" class="header-anchor">#</a> Eine Applikation (neu-)starten</h3> <ol><li>In jeweilges Verzeichnis wechseln
<code>cd /etc/docker-configs/foo</code></li> <li>Applikation starten
<code>docker-compose up -d</code></li></ol> <h3 id="alle-unbenutzen-images-loschen"><a href="#alle-unbenutzen-images-loschen" class="header-anchor">#</a> Alle unbenutzen Images löschen</h3> <p><code>docker rmi $(docker image ls -q)</code><br>
(Dieser Befehl versucht zwar alle Images zu löschen, kann aber Images, die aktuell in Benutzung sind nicht löschen 😅)</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/gruppe-adler/wiki.gruppe-adler.de/edit/master/docs/de/infrastruktur/docker-host.md" target="_blank" rel="noopener noreferrer">Diese Seite auf GitHub bearbeiten</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Als letztes geupdatet:</span> <span class="time">9/4/2020, 7:59:50 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/wiki.gruppe-adler.de/de/infrastruktur/" class="prev router-link-active">❔ Einleitung</a></span> <span class="next"><a href="/wiki.gruppe-adler.de/de/infrastruktur/gruppe-adler-modset.html">📁 Gruppe Adler Modset</a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/wiki.gruppe-adler.de/assets/js/app.1b06e0ef.js" defer></script><script src="/wiki.gruppe-adler.de/assets/js/4.01aab508.js" defer></script><script src="/wiki.gruppe-adler.de/assets/js/1.9d972ef3.js" defer></script><script src="/wiki.gruppe-adler.de/assets/js/15.cf06986b.js" defer></script>
  </body>
</html>
